[tools]
golang = "1.26.0"
node = "22.14.0"
tree-sitter = "0.26.5"
golangci-lint = "2.10.1"
lefthook = "2.1.1"
goreleaser = "2.14.0"

[tasks.ci]
description = "Run formatter, linters, and tests (Go + VS Code extension)"
depends = ["format", "lint", "test", "vscode-ci"]

[tasks.format]
description = "Format Go code with golangci-lint formatters"
run = "golangci-lint fmt"
alias = "fmt"

[tasks.lint]
description = "Run golangci-lint"
run = "golangci-lint run"

[tasks.test]
description = "Run Go tests"
run = "go test ./..."

[tasks.vscode-install]
description = "Install VS Code extension dev dependencies (lockfile)"
run = "npm --prefix editors/vscode ci"

[tasks.vscode-compile]
description = "Compile VS Code extension TypeScript"
depends = ["vscode-install"]
run = "npm --prefix editors/vscode run compile"

[tasks.vscode-test]
description = "Run VS Code extension tests (typecheck + syntax smoke)"
depends = ["vscode-install"]
run = "npm --prefix editors/vscode run test"

[tasks.vscode-ci]
description = "Run VS Code extension compile + tests"
depends = ["vscode-compile", "vscode-test"]

[tasks.vscode-install-extension]
description = "Compile and install VS Code extension"
depends = ["vscode-compile"]
run = "npm --prefix editors/vscode run package && code --install-extension editors/vscode/thrift-weaver-vscode-0.0.1.vsix --force"
